#*********************************************************************
# GET TRACEPATH:
# Input   <- get YYYYMMDD from MLBondFile specifics to look for tracePath
#         <- get td
# Outputs -> set TracePath
#            return TracePath
#*********************************************************************

traceDatesFilter <- function(yyyymmdd ,td = "Z:\\TraceData\\History\\"){

# install hash Package
#install.packages("hash")
library(hash)


setwd(td)    
  
# Trace hash
dates <- list("20160212", # 02 23
              "20160218", # 02 24 -- 03 03
              "20160303", # 03 04 -- 03 07
              "20160307", # 03-08
              "20160308", # 03-09
              "20160309", # 03-10
              "20160310", # 03-11
              "20160311", # 14
              "20160314", # 15
              "20160315", # 16
              "20160316", # 17
              "20160317", # 18
              "20160318", # 21
              "20160321", # 22
              "20160322", # 23
              "20160323", # 24
              "20160324", # 25, 28
              "20160328", # 29
              "20160329", # 30
              "20160330", # 31
              "20160331", # 04 01
              "20160401", # 04
              "20160404", # 05
              "20160405", # 06
              "20160406", 
              "20160407",
              "20160408",
              "20160411",
              "20160412",
              "20160413",
              "20160414",
              "20160415",
              "20160418",
              "20160419",
              "20160420",
              "20160421",
              "20160422",
              "20160425",
              "20160426",
              "20160427",
              "20160428",
              "20160429",
              "20160502",
              "20160503",
              "20160504",
              "20160505",
              "20160506",
              "20160509",
              "20160510",
              "20160511",
              "20160512",
              "20160513",
              "20160516",
              "20160517",
              "20160518",
              "20160519",
              "20160520",
              "20160523",
              "20160524",
              "20160525")           

folderDates <- list("2016 02 23",
                             list("2016 02 24"),#, "2016 02 25", "2016 02 26", "2016 02 29", "2016 03 01", "2016 03 02", "2016 03 03"),
                             list("2016 03 04"),#, "2016 03 07"),
                             "2016 03 08", 
                             "2016 03 09", 
                             "2016 03 10",
                             "2016 03 11",
                             "2016 03 14",
                             "2016 03 15",
                             "2016 03 16", 
                             "2016 03 17",
                             "2016 03 18",
                             "2016 03 21", 
                             "2016 03 22",
                             "2016 03 23",
                             "2016 03 24",
                             list("2016 03 25"),#,"2016 03 28"),
                             "2016 03 29", 
                             "2016 03 30",
                             "2016 03 31",
                             "2016 04 01", #
                             "2016 04 04",
                             "2016 04 05",
                             "2016 04 06",
                             "2016 04 07",
                             "2016 04 08",
                             "2016 04 11",
                             "2016 04 12",
                             "2016 04 13",
                             "2016 04 14",
                             "2016 04 15",
                             "2016 04 18",
                             "2016 04 19",
                             "2016 04 20",
                             "2016 04 21",
                             "2016 04 22",
                             "2016 04 25",
                             "2016 04 26",
                             "2016 04 27",
                             "2016 04 28",
                             "2016 04 29",
                             "2016 05 02",
                             "2016 05 03",
                             "2016 05 04",
                             "2016 05 05",
                             "2016 05 06",
                             "2016 05 09",
                             "2016 05 10",
                             "2016 05 11",
                             "2016 05 12",
                             "2016 05 13",
                             "2016 05 16",
                             "2016 05 17",
                             "2016 05 18",
                             "2016 05 19",
                             "2016 05 20",
                             "2016 05 23",
                             "2016 05 24",
                             "2016 05 25",
                             "2016 05 26")    
              
trace_hash <- hash(keys = dates, values = folderDates)

# IF DEBUG------------------------------------------------------------------------
trace_hash[["20160524"]]
# DEBUG END-----------------------------------------------------------------------

#***********************************************
#STEP 1: Compare if YYYYMMDD belongs to tracelist 
#***********************************************
strcmpr <- match(yyyymmdd, dates);  

#return(strcmpr)

#if(FALSE) { # DEBUG BEGIN-----------------------------

# Whether given date is traceData Date
if(!is.na(strcmpr)){
  
  return(trace_hash[[yyyymmdd]])
  
}
else {
  
  return(paste(substr(yyyymmdd,1,4), substr(yyyymmdd,5,6), substr(yyyymmdd,7,8), sep =" "))
  
}

#} # DEBUG END-------------------------------------------
  
} # END getTracePath



